设计一款nvme ssd测试系统，测试软件使用Python语言，测试软件界面使用pysimplegui 4.x版本，因为5.x版本是收费的

测试系统硬件包括一台console主机（Windows系统）；若干台测试主机（liunx系统）；一台高低温试验箱

console主机通过串口控制高低温实验箱的运行；console主机通过网线控制若干台测试主机的运行；被测试的nvme ssd连接到测试主机上，并被放置于高低温试验箱

测试软件运行在console主机上，是测试系统的大脑
测试软件界面包括以下内容：
1、串口控制温箱模块
2、ssd测试模块（包含ssd实时测试进度展示模块）
3、实时监控模块

各个模块的具体实现方式
1、串口模块
展示温箱温度，温箱保温倒计时
测试系统的测试软件通过串口控制温箱，温箱的串口配置，波特率：2400；校验位：无（N）；数据长度：8位；停止位：1位；
测试系统的测试软件通过串口控制温箱的命令有2套命令，如下：
第一套命令：
运行温箱，发送命令：01 05 1F 40 FF 00 8A 3A
停止温箱，发送命令：01 05 1F 41 FF 00 DB FA
读取温箱温度，发送命令：01 03 1F 37 00 01 32 10，温箱回复：01 03 02 02 60 B9 0C，其中02 60代表寄存器值16进制数，转换成十进制为608， 608/10=60.8℃
设定温箱正温度，发送命令：01 06 1F A4 01 0E 4F A9，其中01 0E代表寄存器的值为十进制数270，270/10=27℃，表明设定温度温度27℃；4F A9表示校验码，计算方式是把"01 06 1F A4 01 0E"代入到CRC16/MODBUS算法内
设定温箱负温度，发送命令：01 06 1F A4 FF 1A 0F C6，其中FF 1A代表十进制65536-230=65306，即设定温度为-23℃；0F C6表示校验码，计算方式同上
第二套命令：
运行温箱，发送命令：W9902A
停止温箱，发送命令：W9901A
读取温箱温度，发送命令：R99A，温箱回复：01 00 09 00 00 00 01 02 00 00 00 00 01 02 00 02 04 02 05 00 02 00 00 00 00 08 07 00 00 00 00 00 00 00 f0 2e cc，其中第28到40位是关于温度的信息，如01 02 04 02 05 01，这其中前面的01 02 04 02 05表示温度为124.25℃，最后的01表示温度为负值
设定温箱温度，发送命令：W01{data}{符号位}0000A，其中data为温度信息，总共5位，如24℃，就是02400，符号位1位，0表示正温度，1表示负温度

2、ssd测试模块
2.1、测试软件可读取测试脚本来定制化测试内容，测试脚本为.ini文件，内容实例如下：
# 脚本示例详解
# TEMP 25 100:温度设定25度，保温100秒
# PCT 100:PCT（开关机测试） 测试100轮
# BIT 100:BIT（老化测试） 测试100%的SSD容量，也就是全盘BIT，这个数字必须是1-100之间的整数。
# CTTW :CTTW（跨温区测试，写测试） 测试100%的SSD容量，也就是全盘写一遍
# CTTR :CTTR（跨温区测试，读测试） 测试100%的SSD容量，也就是全盘读一遍
TEMP 25 10
PCT 10
BIT 1

TEMP   -42     3600
PCT      100
BIT  100
CTTW

TEMP 87 3600
CTTR
PCT 100
BIT   100
CTTW

TEMP -42 3600
CTTR
PCT 100
BIT  100
CTTW

TEMP 87 3600
CTTR
PCT 100
BIT  100

TEMP 25 600
PCT 10
BIT   100

以上为测试脚本内容实例，需要读取并理解条目，依次执行条目测试内容。



2.2、测试软件通过网线控制若干台测试主机
测试软件通过ssh功能控制主机，主机的远程管理ssh的用户为root，密码为1.
PCT测试流程如下：
通过wake on lan功能使测试主机开机
等待若干秒，如40秒
通过ssh功能，访问被测主机，探查测试主机是否已经开机
如果已经开机，则发送PCT测试命令，测试ssd
等待所有主机测试完
所有主机测试完发送关机命令：shutdown -h now
等待所有主机关机完成，如等待15秒
如上流程为一个PCT的流程，通过循环测试完所有PCT

发送的PCT测试命令应包括：
获取ssd的基础信息，如MN SN VID DID等
获取ssd的连接状态，判断是否是gen3x4
获取ssd的smart信息
使用fio命令依次测试所有主板上的ssd，fio命令如下：fio --ioengine=libaio --bs=1M --iodepth=128 --numjobs=1 --direct=1   --name=test --rw=write --filename=$i --verify=crc32c --do_verify=1  --group_reporting  --size=1G，其中$i为ssd的路径信息，如/dev/nvme0n1,/dev/nvme1n1等

BIT测试流程与一个PCT流程一样，其中发送测试命令需改成BIT测试命令
发送的BIT测试命令应包括：
获取ssd的基础信息，如MN SN VID DID等
获取ssd的连接状态，判断是否是gen3x4
获取ssd的smart信息
使用fio同步测试所有主板上的ssd，fio命令如下：fio --ioengine=libaio --bs=1M --iodepth=128 --numjobs=1 --direct=1   --name=test --rw=write --filename=$i --verify=crc32c --do_verify=1  --group_reporting  --size="$2"%，其中$i为ssd的路径信息，如/dev/nvme0n1,/dev/nvme1n1等，$2为测试SSD容量的比例。由于这条命令测试时间长，并且所有ssd同步测试，所有测试结果获取需要特殊处理。另外测试这条命令的同时需要每隔30秒获取被测ssd盘的温度信息

CTTW测试流程与一个PCT流程一样，其中发送测试命令需改成CTTW测试命令
发送的CTTW测试命令应包括：
获取ssd的基础信息，如MN SN VID DID等
获取ssd的连接状态，判断是否是gen3x4
获取ssd的smart信息
使用fio同步测试所有主板上的ssd，fio命令如下：fio --ioengine=libaio --bs=1M --iodepth=128 --numjobs=1 --direct=1   --name=test --rw=write --filename=$i --verify=crc32c --do_verify=0  --group_reporting  --size=100%，其中$i为ssd的路径信息，如/dev/nvme0n1,/dev/nvme1n1等。由于这条命令测试时间长，并且所有ssd同步测试，所有测试结果获取需要特殊处理。另外测试这条命令的同时需要每隔30秒获取被测ssd盘的温度信息

CTTR测试流程与一个PCT流程一样，其中发送测试命令需改成CTTW测试命令
发送的CTTR测试命令应包括：
获取ssd的基础信息，如MN SN VID DID等
获取ssd的连接状态，判断是否是gen3x4
获取ssd的smart信息
使用fio同步测试所有主板上的ssd，fio命令如下：fio --ioengine=libaio --bs=1M --iodepth=128 --numjobs=1 --direct=1   --name=test --rw=read --filename=$i --verify=crc32c --do_verify=1  --group_reporting  --size=100%，其中$i为ssd的路径信息，如/dev/nvme0n1,/dev/nvme1n1等。由于这条命令测试时间长，并且所有ssd同步测试，所有测试结果获取需要特殊处理。另外测试这条命令的同时需要每隔30秒获取被测ssd盘的温度信息

2.3、ssd实时测试模块
需要记录每个测试主板上初始测试时的盘的信息，后续每条测试需要检查是否与第一次盘的信息一致
展示测试盘的测试进度，当前测试信息

3、实时监控模块
用于展示人机交互时的过程以及一些关键信息

测试软件测试ssd的测试结果保存路径如下所示：
./nvme_test_log/测试时间/测试盘sn/{name}.txt
name的构成：测试时间-测试盘sn-测试项目-测试温度

测试软件具有自身运行日志记录功能，保存路径如下：
./console_log/log.txt
日志文件过大时需要分割为不同的文件

测试软件使用Python语言，变量命名使用蛇形命名法

测试软件需具备参数配置能力，配置文件保存路径：
./config.ini

测试软件需具备测试结果分析能力，如ssd测试过程中掉盘，不识盘，链路链接异常，测试温度过高等。并在测试结果文件里面展示出来
测试结果展示可使用html文件，要求展示内容丰富，图文并茂

测试软件需具备版本管理功能，便于记录版本更改

fio 写命令但不校验
fio --ioengine=libaio --bs=1M --iodepth=128 --numjobs=1 --direct=1 --name=test --rw=write --filename=$i --verify=crc32c --do_verify=0  --group_reporting  --size=1G；其中$i为ssd的路径信息，如/dev/nvme0n1,/dev/nvme1n1等
fio 读命令检验
fio --ioengine=libaio --bs=1M --iodepth=128 --numjobs=1 --direct=1 --name=test --rw=read --filename=$i --verify=crc32c --do_verify=1  --group_reporting  --size=1G；其中$i为ssd的路径信息，如/dev/nvme0n1,/dev/nvme1n1等



